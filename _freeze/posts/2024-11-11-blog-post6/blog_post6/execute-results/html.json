{
  "hash": "1f50139c0cbd2713e073dcfd34787833",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Blog post6\"\nsubtitle: \"\"\nauthor: \"group 3\"\ndate: \"2024-11-11\"\ndescription: \"\"\nimage-alt: \"\"\ncategories: []\ndate-modified: \"2024-11-18\"\ndraft: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n# Some EDA about the second dataset\ndebt_degree <- read_csv(here::here(\"dataset-ignore\", \"Most-Recent-Cohorts-Field-of-Study.csv\"), show_col_types = FALSE) |>\n  select(c(CREDDESC, DEBT_ALL_STGP_EVAL_MDN)) |>\n  filter(CREDDESC != \"PS\", DEBT_ALL_STGP_EVAL_MDN != \"PS\") |>\n  mutate(DEBT_ALL_STGP_EVAL_MDN = as.numeric(DEBT_ALL_STGP_EVAL_MDN))\ndebt_summary <- debt_degree |>\n  group_by(CREDDESC) |>\n  summarise(mean_debt = mean(DEBT_ALL_STGP_EVAL_MDN, na.rm = TRUE))\n \nggplot(debt_summary, aes(x = CREDDESC, y = mean_debt)) +\n  geom_bar(stat = \"identity\", fill = \"skyblue\") +\n  labs(title = \"Mean Debt by Degree Type\", x = \"Degree Type\", y = \"Mean Debt\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](blog_post6_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nComments: This graph depicts the mean debt of the median total debt taken out at each school by the degree type. This information is derived by the columns: CREDDESC and DEBT_ALL_STGP_EVAL_MDN which provides information on the degree type and median debt taken out for each school respectively. From this, we can infer that the degree which had the highest debt accumulated by the students is \"First Professional Degree\" and the lowest is an \"Undergraduate Certificate or Diploma\". It is important to note that this data does not include transfer students who took loans from another school before attending these ones. Furthermore, the samples size for each degree type is disproportionate.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Some EDA to the new combined dataset\neducation_cohort_combined_data1 <- read_rds(\"dataset/education_cohort_combined_data.rds\")\n#str(education_cohort_combined_data1)\n#summary(education_cohort_combined_data1)\n#head(education_cohort_combined_data1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neducation_cohort_combined_data1 <- education_cohort_combined_data1 |>\n  mutate(\n    EARN_COUNT_WNE_5YR = as.numeric(EARN_COUNT_WNE_5YR)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `EARN_COUNT_WNE_5YR = as.numeric(EARN_COUNT_WNE_5YR)`.\nCaused by warning:\n! NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\nfield_summary <- education_cohort_combined_data1 |>\n  group_by(CIPDESC) |>\n  summarise(\n    Avg_Working_5YR = mean(EARN_COUNT_WNE_5YR, na.rm = TRUE),\n    Total_Working_5YR = sum(EARN_COUNT_WNE_5YR, na.rm = TRUE),\n    Count = n()\n  ) |>\n  arrange(desc(Total_Working_5YR))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ntop_fields <- field_summary |>\n  top_n(20, Total_Working_5YR)\n#Listing the fields of study with the highest employment outcomes in a descending order\nggplot(top_fields, aes(x = reorder(CIPDESC, -Total_Working_5YR), y = Total_Working_5YR)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Top Fields of Study by Employment Outcomes\", x = \"Field of Study\", y = \"Total Employed(5 yrs After Completion)\")\n```\n\n::: {.cell-output-display}\n![](blog_post6_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Have to use coord_flip() because otherwise the names of different fields of study will be overlapped with each other\n```\n:::\n\n\nComments: Used CIPDESC and EARN_COUNT_WNE_5YR from the combined dataset to create a bar chart listing the top 20 fields of study with the highest employment.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\neducation_cohort_combined_data1$EARN_MDN_5YR <- as.numeric(gsub(\"[^0-9]\", \"\", education_cohort_combined_data1$EARN_MDN_5YR))\n# education_cohort_combined_data1\n\nsum(is.na(education_cohort_combined_data1$EARN_MDN_5YR))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5100\n```\n\n\n:::\n\n```{.r .cell-code}\ncleaned_data <- education_cohort_combined_data1 %>% \n                filter(!is.na(EARN_MDN_5YR))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(EARN_MDN_5YR ~ UGDS_WHITE + UGDS_BLACK + UGDS_HISP + UGDS_ASIAN + IRPS_WHITE + IRPS_BLACK + IRPS_HISP + IRPS_ASIAN, \n            data = cleaned_data)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = EARN_MDN_5YR ~ UGDS_WHITE + UGDS_BLACK + UGDS_HISP + \n    UGDS_ASIAN + IRPS_WHITE + IRPS_BLACK + IRPS_HISP + IRPS_ASIAN, \n    data = cleaned_data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-93375 -18609  -5127  13279 180362 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    95642      10517   9.094  < 2e-16 ***\nUGDS_WHITE     17651      10089   1.750   0.0804 .  \nUGDS_BLACK     16666      16191   1.029   0.3035    \nUGDS_HISP     -16938      15476  -1.094   0.2739    \nUGDS_ASIAN    177237      20361   8.705  < 2e-16 ***\nIRPS_WHITE    -47362       9251  -5.120 3.49e-07 ***\nIRPS_BLACK    -78703      19683  -3.999 6.71e-05 ***\nIRPS_HISP    -163735      25878  -6.327 3.37e-10 ***\nIRPS_ASIAN    -15039      18076  -0.832   0.4055    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 28720 on 1379 degrees of freedom\n  (11 observations deleted due to missingness)\nMultiple R-squared:  0.2676,\tAdjusted R-squared:  0.2633 \nF-statistic: 62.97 on 8 and 1379 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Compare predicted values with actual values to evaluate model performance.\n\npredictions <- predict(model, cleaned_data)\n\nggplot(cleaned_data, aes(x = predictions, y = EARN_MDN_5YR)) +\n    geom_point(color = \"blue\") +\n    geom_abline(intercept = 0, slope = 1, color = \"red\", linetype = \"dashed\") +\n    labs(title = \"Predicted vs Observed Values\",\n         x = \"Predicted\",\n         y = \"Observed\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 11 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](blog_post6_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reshape the data to long format\nlong_data <- cleaned_data %>%\n  pivot_longer(cols = starts_with(\"UGDS_\"), \n               names_to = \"Race\", \n               values_to = \"Proportion\")\n\n# Check the reshaped data\nhead(long_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 116\n  INSTNM   EARN_COUNT_WNE_5YR EARN_MDN_5YR CIPDESC CREDDESC D150_4 D150_4_POOLED\n  <chr>                 <dbl>        <dbl> <chr>   <chr>     <dbl>         <dbl>\n1 Alexand…                 22        16091 Cosmet… Undergr…     NA            NA\n2 Alexand…                 22        16091 Cosmet… Undergr…     NA            NA\n3 Alexand…                 22        16091 Cosmet… Undergr…     NA            NA\n4 Alexand…                 22        16091 Cosmet… Undergr…     NA            NA\n5 Alexand…                 22        16091 Cosmet… Undergr…     NA            NA\n6 Alexand…                 22        16091 Cosmet… Undergr…     NA            NA\n# ℹ 109 more variables: D150_4_WHITE <dbl>, D150_4_BLACK <dbl>,\n#   D150_4_HISP <dbl>, D150_4_ASIAN <dbl>, D150_4_AIAN <dbl>,\n#   D150_4_NHPI <dbl>, D150_4_2MOR <dbl>, D150_4_NRA <dbl>, D150_4_UNKN <dbl>,\n#   D150_4_WHITENH <lgl>, D150_4_BLACKNH <lgl>, D150_4_API <lgl>,\n#   D150_4_AIANOLD <lgl>, D150_4_HISPOLD <lgl>, D150_4_PELL <dbl>,\n#   D150_4_LOANNOPELL <dbl>, D150_4_NOLOANNOPELL <dbl>,\n#   D150_4_PELL_POOLED <dbl>, IRPS_2MOR <dbl>, IRPS_AIAN <dbl>, …\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(long_data, aes(x = Proportion, y = EARN_MDN_5YR)) +\n  geom_point(alpha = 0.5, color = \"blue\") +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"red\") +\n  facet_wrap(~Race, scales = \"free_x\") +\n  labs(title = \"Effect of Race Proportions on Earnings\",\n       x = \"Proportion of Race\",\n       y = \"Median Earnings (5 years)\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 7094 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 7094 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](blog_post6_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::",
    "supporting": [
      "blog_post6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}