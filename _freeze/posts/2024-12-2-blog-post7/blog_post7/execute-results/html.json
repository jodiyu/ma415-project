{
  "hash": "3ebcfaabe38ada57c875fccbab1bf18e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Blog post7\"\nsubtitle: \"\"\nauthor: \"group 3\"\ndate: \"2024-12-2\"\ndescription: \"Thesis: The level of tuition paid is a significant predictor of employment success, with higher tuition payments correlating to increased earnings within the first five years after college. The ability to afford higher tuition is closely linked to socioeconomic status and parental income. This relationship perpetuates the cycle of poverty and systemic disparities, disproportionately affecting Black students and other minority groups.\"\nimage-alt: \"\"\ncategories: []\ndate-modified: \"2024-12-9\"\ndraft: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neducation_cohort_combined_data1 <- read_rds(\"dataset/education_cohort_combined_data.rds\")\n\neducation_cohort_combined_data1 <- education_cohort_combined_data1 |>\n  mutate(\n    EARN_MDN_5YR = as.numeric(EARN_MDN_5YR)\n  ) |>\n  select(\n    'EARN_MDN_5YR',\n    'INSTNM',\n    'EARN_COUNT_WNE_5YR',\n    'CIPDESC',\n    'CREDDESC',\n    'ZIP',\n    starts_with('PCT_'),\n    'NPT4_PRIV',\n    'NPT4_PUB'\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `EARN_MDN_5YR = as.numeric(EARN_MDN_5YR)`.\nCaused by warning:\n! NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\nfield_summary <- education_cohort_combined_data1 |>\n  group_by(CIPDESC) |>\n  summarise(\n    Avg_Earning_5YR = mean(EARN_MDN_5YR, na.rm = TRUE),\n    Total_Earning_5YR = sum(EARN_MDN_5YR, na.rm = TRUE),\n    Count = n()\n  ) |>\n  arrange(desc(Total_Earning_5YR))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nInstitution_summary <- education_cohort_combined_data1 |>\n  group_by(INSTNM) |>\n  summarise(\n    Avg_Earning_5YR = mean(EARN_MDN_5YR, na.rm = TRUE),\n    Total_Earning_5YR = sum(EARN_MDN_5YR, na.rm = TRUE),\n    Count = n()\n  ) |>\n  arrange(desc(Total_Earning_5YR)) |>\n  arrange(desc(Avg_Earning_5YR))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntop_schools_tuition <- education_cohort_combined_data1 |> # listing schools with the tuition from high to low\n  mutate(Max_Tuition = pmax(NPT4_PUB, NPT4_PRIV, na.rm = TRUE)) |>\n  group_by(INSTNM) |>\n  summarise(Max_Tuition = max(Max_Tuition, na.rm = TRUE)) |>\n  arrange(desc(Max_Tuition))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There were 20 warnings in `summarise()`.\nThe first warning was:\nℹ In argument: `Max_Tuition = max(Max_Tuition, na.rm = TRUE)`.\nℹ In group 8: `INSTNM = \"Bancroft School of Massage Therapy\"`.\nCaused by warning in `max()`:\n! no non-missing arguments to max; returning -Inf\nℹ Run `dplyr::last_dplyr_warnings()` to see the 19 remaining warnings.\n```\n\n\n:::\n\n```{.r .cell-code}\n  top_schools <- top_schools_tuition |>\n    top_n(20, Max_Tuition)\n  ggplot(top_schools, aes(x = reorder(INSTNM, Max_Tuition), y = Max_Tuition)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  coord_flip() +\n  labs(\n    title = \"Top 20 Schools with the Most Expensive Tuition\",\n    x = \"School Name\",\n    y = \"Tuition Cost (in $)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](blog_post7_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Total earnings of different fields of study ranking\ntop_fields <- field_summary |>\n  top_n(30, Total_Earning_5YR)\n#Listing the fields of study with the highest employment outcomes in a descending order\nggplot(top_fields, aes(x = reorder(CIPDESC, -Total_Earning_5YR), y = Total_Earning_5YR)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Top Fields of Study Total Earnings\", x = \"Field of Study\", y = \"Total Earnings)\")\n```\n\n::: {.cell-output-display}\n![](blog_post7_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Average earnings of different fields of study ranking\ntop_fields2 <- field_summary |>\n  top_n(30, Avg_Earning_5YR)\n#Listing the fields of study with the highest employment outcomes in a descending order\nggplot(top_fields2, aes(x = reorder(CIPDESC, -Avg_Earning_5YR), y = Avg_Earning_5YR)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Top Fields of Study Average Earnings\", x = \"Field of Study\", y = \"Average Earnings)\")\n```\n\n::: {.cell-output-display}\n![](blog_post7_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Bar chart for top institutions in Massachusetts\ntop_institutions <- Institution_summary %>%\n  top_n(10, Avg_Earning_5YR)\n\nggplot(top_institutions, aes(x = reorder(INSTNM, -Avg_Earning_5YR), y = Avg_Earning_5YR)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(title = \"Top Institutions by Employment Outcomes\", x = \"Institution\", y = \"Average Earning (5 Years After Completion)\")\n```\n\n::: {.cell-output-display}\n![](blog_post7_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert PCT_RACE to numeric\neducation_cohort_combined_data1$PCT_WHITE <- as.numeric(education_cohort_combined_data1$PCT_WHITE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\neducation_cohort_combined_data1$PCT_BLACK <- as.numeric(education_cohort_combined_data1$PCT_BLACK)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\neducation_cohort_combined_data1$PCT_ASIAN <- as.numeric(education_cohort_combined_data1$PCT_ASIAN)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\neducation_cohort_combined_data1$PCT_HISPANIC <- as.numeric(education_cohort_combined_data1$PCT_HISPANIC)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check if columns used in weighted.mean are numeric\nstr(education_cohort_combined_data1$PCT_WHITE)  # Should be numeric\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n num [1:6499] NA 74.5 74.5 74.5 74.5 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nstr(education_cohort_combined_data1$EARN_COUNT_WNE_5YR)  # Should be numeric\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n chr [1:6499] \"22\" \"PS\" \"PS\" \"170\" \"82\" \"PS\" \"50\" \"PS\" \"PS\" \"30\" \"PS\" \"PS\" ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\neducation_cohort_combined_data1 <- education_cohort_combined_data1 |>\n  mutate(\n    EARN_COUNT_WNE_5YR = as.numeric(EARN_COUNT_WNE_5YR)  # Convert to numeric\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `EARN_COUNT_WNE_5YR = as.numeric(EARN_COUNT_WNE_5YR)`.\nCaused by warning:\n! NAs introduced by coercion\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove rows with NA in key columns\neducation_cohort_combined_data1 <- education_cohort_combined_data1 |>\n  filter(!is.na(EARN_MDN_5YR) & !is.na(PCT_WHITE) & !is.na(PCT_BLACK))\n\nfield_race_summary <- education_cohort_combined_data1 |>\n  group_by(CIPDESC) |>\n  summarise(\n    Avg_White = weighted.mean(PCT_WHITE, EARN_COUNT_WNE_5YR, na.rm = TRUE),\n    Avg_Black = weighted.mean(PCT_BLACK, EARN_COUNT_WNE_5YR, na.rm = TRUE),\n    Avg_Hispanic = weighted.mean(PCT_HISPANIC, EARN_COUNT_WNE_5YR, na.rm = TRUE),\n    Avg_Asian = weighted.mean(PCT_ASIAN, EARN_COUNT_WNE_5YR, na.rm = TRUE),\n    Avg_Earnings = mean(EARN_MDN_5YR, na.rm = TRUE)\n  ) |>\n  arrange(desc(Avg_Earnings))\n\nfield_race_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 198 × 6\n   CIPDESC               Avg_White Avg_Black Avg_Hispanic Avg_Asian Avg_Earnings\n   <chr>                     <dbl>     <dbl>        <dbl>     <dbl>        <dbl>\n 1 Advanced/Graduate De…      77.2      9.20        10.1       6.45      241981 \n 2 Statistics.                74.1     10.3         11.9       7.40      229811 \n 3 Applied Mathematics.       74.1     10.3         11.9       7.40      178318 \n 4 Dentistry.                 80.4      7.80         8.67      5.64      164715.\n 5 Systems Engineering.       80.7      7.02        10.5       5.63      164194 \n 6 Computer Science.          82.8      6.36         8.16      4.89      155370.\n 7 Human Computer Inter…      85.6      5.47         6.12      4.16      152624.\n 8 Computer Engineering.      83.7      6.09         7.31      4.69      146994.\n 9 Engineering-Related …      86.3      5.51         5.72      3.57      139144.\n10 Taxation.                  86.2      5.25         5.69      3.85      134286.\n# ℹ 188 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combine tuition columns, arrange by descending tuition, and calculate mean earnings\ntuition_earnings_table <- education_cohort_combined_data1 |>\n  mutate(tuition = coalesce(NPT4_PRIV, NPT4_PUB)) |>  # Combine tuition columns\n  group_by(INSTNM) |>  # Group by institution\n  summarize(\n    mean_earn_5yr = mean(EARN_MDN_5YR, na.rm = TRUE),  # Calculate mean of earnings\n    max_tuition = max(tuition, na.rm = TRUE),  # Get maximum tuition for each institution\n    .groups = \"drop\"\n  ) |>\n  arrange(desc(max_tuition))  # Arrange by tuition in descending order\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There were 10 warnings in `summarize()`.\nThe first warning was:\nℹ In argument: `max_tuition = max(tuition, na.rm = TRUE)`.\nℹ In group 36: `INSTNM = \"FINE Mortuary College\"`.\nCaused by warning in `max()`:\n! no non-missing arguments to max; returning -Inf\nℹ Run `dplyr::last_dplyr_warnings()` to see the 9 remaining warnings.\n```\n\n\n:::\n\n```{.r .cell-code}\ntuition_earnings_table\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 116 × 3\n   INSTNM                            mean_earn_5yr max_tuition\n   <chr>                                     <dbl>       <dbl>\n 1 Emerson College                          61689.       49466\n 2 Berklee College of Music                 36313        49230\n 3 Worcester Polytechnic Institute         112364.       44100\n 4 Bay State College                        62752.       41133\n 5 Bentley University                      115491.       39699\n 6 College of the Holy Cross                82256.       39310\n 7 Boston College                           97127.       39090\n 8 MCPHS University                        100113.       37351\n 9 Endicott College                         76680.       36959\n10 Wentworth Institute of Technology        95824.       36750\n# ℹ 106 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create scatter plot with best-fit line\nggplot(tuition_earnings_table, aes(x = max_tuition, y = mean_earn_5yr)) +\n  geom_point(color = \"blue\", size = 3) +  # Scatter points\n  geom_smooth(method = \"lm\", color = \"red\", se = TRUE) +  # Best-fit line with confidence interval\n  labs(\n    title = \"Mean Earnings vs. Maximum Tuition with Best-Fit Line\",\n    x = \"Maximum Tuition\",\n    y = \"Mean Earnings 5 Years After Graduation\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 10 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](blog_post7_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::",
    "supporting": [
      "blog_post7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}